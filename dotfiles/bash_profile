#!/bin/env/bash
# ~/.bash_profile

# Test for an interactive shell.  There is no need to set anything
# past this point for scp and rcp, and it's important to refrain from
# outputting anything in those cases.
if [[ $- != *i* ]] ; then
	# Shell is not interactive
	return
fi

# default prompt
PS1=" \w \$ "

# don't put duplicate lines or lines starting with space in the history
# See bash(1) for more options
HISTCONTROL=ignoreboth:erasedups

# append to the history file, don't overwrite it
shopt -s histappend

# Make bash check its window size after a process completes
shopt -s checkwinsize

# for setting history length see HISTSIZE and HISTFILESIZE in bash(1)
HISTSIZE=1000
HISTFILESIZE=2000

# path
PATH="$HOME/bin:$HOME/.local/bin:$PATH"

# editor
export EDITOR=/usr/local/bin/vim
export VISUAL="$EDITOR"

# aliases
alias date="date +"%F %r"
alias du="du -ach | sort -h"
alias ls="ls -1G"
alias tb="nc termbin.com 9999"
alias getip="curl -4 icanhazip.com"
alias projects="cd "$HOME"/projects"
alias exitcode="echo $?"
alias gityolo="git commit -a -m "$(curl http://whatthecommit.com)" && git push"

alias youtube-dl="youtube-dl --external-downloader aria2c --external-downloader-args '-c -j 3 -x 3 -s 3 -k 1M' "$0" -o"

# os-specific aliases and functions
if [[ $(uname -s) == Darwin ]]; then
  # aliases
  alias afk="pmset displaysleepnow"
  alias cleanup="find . -type f -name '.DS_Store' -print -delete"
  alias flushdns='sudo killall -HUP mDNSResponder'

  # functions
  gam() {
    "/Users/josh/bin/gam/gam" "$@" ;
  }

  timestamp () {
    date +"%F %r" | tr -d "\n" | pbcopy
  }

  # completion
  [[ -r "$HOME/.iterm2_shell_integration.bash" ]] && source "$HOME/.iterm2_shell_integration.bash"
  [[ -r "/usr/local/etc/profile.d/bash_completion.sh" ]] && source "/usr/local/etc/profile.d/bash_completion.sh"

  # google cloud sdk
  source "/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/path.bash.inc" \
    || { echo 'Could not source google-cloud-bash-includes!' >&2; exit 1; }
  source "/usr/local/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/completion.bash.inc" \
    || { echo 'Could not source google-cloud-bash-completion!' >&2; exit 1; }
fi

if [[ $(uname -s) == Linux ]]; then
  true
fi

# functions
mkcd() {
  mkdir -p "$@" && cd "$@" || exit
}

mkrandir() {
  dir="$(openssl rand -hex 8)"
  mkdir -p "$dir" && cd "$dir" || exit
}

genpass () {
  python3 -c "import secrets; print(secrets.token_urlsafe(16))"
}

reload () {
  unalias -a
  source "$HOME/.bash_profile"
}